from boofuzz import *


host = "192.168.0.231"
port = 3260
proto = "tcp"

session = Session(
    target=Target(
        connection=SocketConnection(host, port, proto)
    )
)

s_initialize("login command")
s_byte(0x43,fuzzable=False)  # OP_CODE Login Command
s_byte(0x87,fuzzable=False)  # Diff bits
s_byte(0x00)  # Version Max
s_byte(0x00)  # Version Min
s_byte(0x00,fuzzable=False)  # Total AHS Length
s_bytes(value=b'\x00\x01\x05', size=3,fuzzable=False)  # length
s_bytes(value=b'\x00\x02\x3d\x00\x00\x00', size=6,fuzzable=True)  # ISID
s_bytes(value=b'\x00\x00', size=2,fuzzable=True)  # TSIH
s_bytes(value=b'\x00\x00\x00\x00', size=4,fuzzable=True)  # Initiator tag
s_bytes(value=b'\x00\x00', size=2,fuzzable=False)  # CID
s_bytes(value=b'\x00\x00', size=2,fuzzable=True)  # RESERVED
s_bytes(value=b'\x00\x00\x00\x01', size=4,fuzzable=True)  # CmdSN
s_bytes(value=b'\x00\x00\x00\x00', size=4,fuzzable=True)  # Expect stat SN
s_bytes(value=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', size=16, fuzzable=False)  # RESERVED
s_bytes(value=b'\x49\x6e\x69\x74\x69\x61\x74\x6f\x72\x4e\x61\x6d\x65\x3d\x69\x71\x6e\x2e\x31\x39'
              b'\x39\x33\x2d\x30\x38\x2e\x6f\x72\x67\x2e\x64\x65\x62\x69\x61\x6e\x3a'
              b'\x30\x31\x3a\x64\x63\x32\x38\x62\x32\x37\x66\x66\x34\x33\x65\x00', size=53, fuzzable=False)  # Login parameter

s_bytes(value=b'\x49\x6e\x69\x74\x69\x61\x74\x6f\x72\x41\x6c\x69\x61\x73'
              b'\x3d\x69\x6e\x69\x74\x69\x61\x74\x6f\x72\x2d\x76\x69'
              b'\x72\x74\x75\x61\x6c\x62\x6f\x78\x00', size=36, fuzzable=False)  # Login parameter

s_bytes(value=b'\x53\x65\x73\x73\x69\x6f\x6e\x54\x79\x70\x65'
              b'\x3d\x44\x69\x73\x63\x6f\x76\x65\x72\x79\x00', size=22,fuzzable=False)  # Padding

s_bytes(value=b'\x48\x65\x61\x64\x65\x72\x44\x69\x67'
              b'\x65\x73\x74\x3d\x4e\x6f\x6e\x65\x00\x44\x61\x74'
              b'\x61\x44\x69\x67\x65\x73\x74\x3d\x4e\x6f\x6e\x65\x00'
              b'\x44\x65\x66\x61\x75\x6c\x74\x54\x69\x6d\x65\x32\x57\x61'
              b'\x69\x74\x3d\x32\x00\x44\x65\x66\x61\x75\x6c\x74\x54\x69'
              b'\x6d\x65\x32\x52\x65\x74\x61\x69\x6e\x3d\x30\x00\x49\x46\x4d'
              b'\x61\x72\x6b\x65\x72\x3d\x4e\x6f\x00\x4f\x46\x4d\x61\x72\x6b'
              b'\x65\x72\x3d\x4e\x6f\x00\x45\x72\x72\x6f\x72\x52\x65\x63'
              b'\x6f\x76\x65\x72\x79\x4c\x65\x76\x65\x6c\x3d\x30\x00\x4d\x61'
              b'\x78\x52\x65\x63\x76\x44\x61\x74\x61\x53\x65\x67\x6d\x65'
              b'\x6e\x74\x4c\x65\x6e\x67\x74\x68\x3d\x33\x32'
              b'\x37\x36\x38\x00\x00\x00\x00', size=153,fuzzable=False)  # Padding


session.connect(s_get("login command"))
session.fuzz()
